<!doctype html>
<html class="theme-next use-motion theme-next-next">
<head>
  

<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>




  <link rel="stylesheet" type="text/css" href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5"/>


<link rel="stylesheet" type="text/css" href="/css/main.css?v=0.4.1"/>




	<meta name="keywords" content="C," />

  <title> 《C专家编程》小记 // Hey!Yahei~ </title>
</head>

<body>
  <div class="container one-column page-post-detail">
    <div class="headband"></div>

    <div id="header" class="header">
      <div class="header-inner">
        <h1 class="site-meta">
  <span class="logo-line-before"><i></i></span>
  <a href="/" class="brand">
      <span class="logo">
        <i class="icon-logo"></i>
      </span>
      <span class="site-title">Hey!Yahei~</span>
  </a>
  <span class="logo-line-after"><i></i></span>
</h1>


  <ul id="menu" class="menu">
    
      
      <li class="menu-item menu-item-home">
        <a href="/">
          <i class="menu-item-icon icon-home"></i> <br />
          首頁
        </a>
      </li>
    
      
      <li class="menu-item menu-item-archives">
        <a href="/archives">
          <i class="menu-item-icon icon-archives"></i> <br />
          歸檔
        </a>
      </li>
    
      
      <li class="menu-item menu-item-tags">
        <a href="/tags">
          <i class="menu-item-icon icon-tags"></i> <br />
          標籤
        </a>
      </li>
    
  </ul>


      </div>
    </div>

    <div id="main" class="main">
      <div class="main-inner">
        <div id="content" class="content">
          
            
          

          <div id="posts" class="posts-expand">
            
  

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              《C专家编程》小记
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          
            發表於 2015-08-30
          
        </span>

        
          
        

        
          
        
      </div>
    </div>

    
      <div class="post-body">

        
        

        
          <p>书上底层的东西比较多，还有些东西不是很理解，等学习完更多的东西后得回头看看<br>知识点比较杂，这里只是简单的把自己觉得有用的东西罗列出来     </p>
<ul>
<li>C语言的基本数据类型与底层硬件相对应  </li>
<li>宏  <ul>
<li>使用应适量，不宜过度使用  </li>
<li>宏名建议要大写  </li>
<li>不宜使用宏来改变C语言的基础结构  </li>
</ul>
</li>
<li>不宜省略形参名  </li>
<li>合法的指针赋值形式  <ol>
<li>两个操作数都是指向有限定符或无限定符的相容类型指针   </li>
<li>左边指针所指向的类型必须具有右边指针所指向类型的全部限定符  </li>
</ol>
</li>
<li>const并不能把一个变量变为一个常量<br>  只是限定它不可修改<br>  const常用于函数的形参  </li>
<li>算术转换<br>  当执行算术运算时，操作数的类型如果不同，就会发生转换。<br>  数据类型一般朝着浮点精度更高，长度更长的方向转换，<br>  整型数如果转换为signed不会丢失信息，就转换为signed，否则转换为unsigned  </li>
<li>sizeof()不是函数，而是运算符，其结果为无符号整型  <ul>
<li>sizeof的操作数如果是类型，必须加括号，如<code>sizeof(int)</code>  </li>
<li>sizeof的操作数如果是变量，有无括号都可以，如<code>sizeof(a)</code>和<code>sizeof a</code></li>
</ul>
</li>
<li>程序中应避免无符号数，以免增加不必要的复杂性  </li>
<li>编程语言的缺陷一般分为三类：<br>  不该做的做了，该做的没做，该做但做的不合适  </li>
<li>NUL 和 NULL<br>  NUL用于结束一个字符串（即<code>\0</code>）<br>  NULL表示一个空指针  </li>
<li>临时变量可声明于花括号的局部空间内（如if、while等语句的花括号内）  </li>
<li>两个相邻的常量字符串会自动合并<br>  注意：两个常量字符串作为函数的两个参数时，如果不小心漏掉了逗号，会出现错误  </li>
<li>C语言中许多符号是被“重载”的，即在不同的上下文环境里有不同的意义  </li>
<li>C语言中部分符号优先级是不符合常规逻辑的，如：   <ol>
<li>==和!=高于位操作符<br> 注意<code>val &amp; mask != 0</code>  </li>
<li>==和!=高于赋值符<br> 注意<code>c = getchar() != EOF</code>  </li>
<li>算数运算符高于移位运算符<br> 注意<code>msk &lt;&lt; 4 + lsb</code>  </li>
</ol>
</li>
<li>逗号表达式的值为最右边操作数的值<br>  注意<code>i = 1, 2</code>  </li>
<li>一些比较老的程序存在诸如<code>if( a == b &amp; c == d )</code>的语句<br>  由于==优先级高于&amp;，所以与<code>if( a == b &amp;&amp; c == d)</code>的执行效果是相同的<br>  历史原因：逻辑运算符是后来从&amp;中分离出来的，但为了兼容旧的代码，只好使==优先级高于&amp;  </li>
<li>一个表达式中各意群的执行顺序是未定义的<br>  如：<code>x = f() + g() * h();</code>，其中f()、g()、h()谁先调用是未定义的（注意f()不一定是在g()和h()之后）  </li>
<li>有些编程专家建议：只记住乘除法优先于加减法即可，其他运算都用括号显式地指定优先级  </li>
<li>结合性用于相同优先级的操作符之间消除歧义；  </li>
<li>优先级相同的操作符，其结合性也相同  </li>
<li>如果计算表达式的值时需要考虑结合性，最好将其一分为二或者使用括号  </li>
<li>函数调用中，各个参数的<strong>计算</strong>顺序是不确定的<br>  但是<strong>传参</strong>顺序是一定的（从右向左）  </li>
<li><em>“在调用函数时，参数按照从右到左的次序压到堆栈里”</em>的说法是错误的<br>  参数在传递时首先<strong>尽可能地放到寄存器</strong>中，以提高速度<br>  注意：<strong>int变量i</strong>与<strong>结构变量s的int成员</strong>的传参方式是不同的<br>  前者一般会传递到寄存器中，后者一般会传递到堆栈中  </li>
<li>gets()函数存在严重漏洞，官方手册强烈建议用fgets()函数取代<br>  即把<code>gets(line)</code>改为<br>  <code>if( fgets(line, sizeof(line), stdin) == NULL ) exit(1);</code>  </li>
<li>C语言中读取argv的选项，其开头必须先判断首字符是否为“-”（有可能是文件名而不是参数）  </li>
<li>尽量避免用<code>\</code>转义回车来将代码分解为多行<br>  万一在<code>\</code>之后不小心加入了空格，将带来难以发现的bug   </li>
<li>maximal munch strategy（最大一口策略）<br>  如果下一个标记有超过一种的解释方案，编译器将选取能组成最长字符序列的方案<br>  如：<code>z=y+++x</code>将被解释为<code>z = (y++) + x</code>（但是最好还是用括号显示表示出来）  </li>
<li>不应试图返回一个指向局部自动变量或数组的指针<br>  若为单一变量，会引起报错<br>  但如果为数组，有可能会因为某些间接形式而不会报错，该bug不易发现  </li>
<li>函数返回数组的方法  <ol>
<li>若为字符串常量，可以直接返回指针  </li>
<li>使用全局声明的数组  </li>
<li>使用静态数组  </li>
<li>显示分配一些堆内存  </li>
<li>最好的方法：由调用者分配堆内存，将内存的指针传入函数   </li>
</ol>
</li>
<li>lint程序已经从编译器中被分离的出来，但是源代码应尽可能通过lint和cstyle程序的检查  </li>
<li>C语言声明形式的原则：与使用形式相似<br>  如：<code>int *p;</code><br>  但是，这种原则并不直观，如指针声明形式改为<code>int &amp;p;</code>更为合理（C++已采纳这种声明形式）   </li>
<li>const和指针<br>  <code>int const * grape;</code>：指向的整型只读<br>  <code>int * const grape;</code>：指针只读<br>  记忆：把const作为类型后缀，接在<code>*</code>之后针对指针，接在<code>int</code>之后针对整型  </li>
<li>声明的结构  <ol>
<li>至少一个<strong>类型说明符</strong>（包含类型说明符、存储类型、类型限定符）  </li>
<li>至少一个<strong>声明器</strong>（包括指针、直接声明器、初始化内容），多个声明器由逗号分隔开  </li>
<li>有且只有一个<strong>分号</strong>  </li>
</ol>
</li>
<li>声明中，与标识符最贴近的（按照优先级、结合性）的符号即为标识符的本质<br>  如：<code>int (*foo[])();</code>，最贴近的是<code>[]</code>，即foo是一个数组    </li>
<li>结构的定义及其变量的声明最好分开<br>  <strong>“一行代码只做一件事”</strong>的C语言编程原则  </li>
<li>如果需要频繁的对整个数组进行赋值操作，可以把该数组放入结构中<br>  （结构变量可以整体赋值）   </li>
<li>联合的作用：  <ol>
<li>节省空间（但在大内存的今天，该作用不大）   </li>
<li>将同一个数据解释成两种不同的东西<br> （下面这个例子可以整体取得整个四字节变量，也可以分别取得各个字节）  </li>
</ol>
</li>
</ul>
<pre><code>union bits32_tag{
    <span class="keyword">int</span> whole;
    <span class="keyword">struct</span> { <span class="keyword">char</span> c0, c1, c2, c3; } <span class="keyword">byte</span>;
} <span class="keyword">value</span>;
</code></pre><ul>
<li>可以巧用枚举类型来方便调试<br>  宏定义的名字在编译时会被丢弃，但枚举名字在调试器中会一直存在   </li>
<li>C语言声明解析方法（见书P64-66）  </li>
<li><code>typedef</code>和<code>#define</code><br>  前者较后者，“封装”更为彻底<br>  后者在声明时能加入其他类型说明符进行扩展，前者声明时不行<br>  如将诸如<code>int (*foo[])();</code>的定义“封装”起来<br>  <code>typedef int (*A[])();</code>和<code>#define NEW(B) ( (*B[])() )</code>  <ol>
<li><code>A x;</code>和<code>NEW(x);</code>等价，均可行    </li>
<li><code>A x, y;</code>和<code>NEW(x, y);</code>不等价，只有前者可行   </li>
</ol>
</li>
<li>不能给typedef加入多个声明器<br>  <em>即不能企图通过typedef定义一个类型名，使之一次性声明多种类型的变量</em>     </li>
<li>不能把“typedef”嵌入到声明当中   </li>
<li>typedef和struct的标签名可以和变量名相同，但应尽量避免   </li>
<li>typedef的用法：<ol>
<li>数组、结构、指针、函数等的组合类型   </li>
<li>可移植类型    </li>
</ol>
</li>
<li>typedef定义的标签名也可以用于强制类型转换    </li>
<li>赋值符左侧的操作数称为左值<br>  左值分为可修改左值和不可修改左值（如数组名）   </li>
<li>编译过程：C预处理器、前端（语法和语义分析）、后端（代码生成器）、优化器、汇编程序、链接-载入器  </li>
<li>静态链接（<code>*.a</code>）：编译过程中，所用到的函数会被装入到可执行文件中（即每个程序对函数代码有一份单独的拷贝）<br>  动态链接（<code>*.so</code>）：编译过程中，只把用到的库文件名或路径名装入可执行文件，需要时再实时调用（即每个程序对函数代码共用一份拷贝）    </li>
<li>动态编译运行速度稍慢，但可执行文件体积小，函数库版本升级更容易，而且部分函数库只能通过动态链接的形式使用   </li>
<li>函数库包含函数的定义，头文件包含函数原型的声明<br>  头文件的名字通常不和它所对应的函数库名相似   </li>
<li>Interpositioning：<br>  自己编写的函数名如果与函数库函数同名，自定义的函数会取代函数库的函数而不会引发编译器的报错     </li>
<li>段<br>  在UNIX中，段是一个二进制文件相关的内容块<br>  在Intel x86内存模型中，地址空间并非一个整体，而是分成若干64K大小的区域，这些区域称为段  </li>
<li>a.out（assembler output，汇编程序输出，一种目标文件格式）依次包含以下内容：   <ol>
<li>a.out的标志数字0407（即Kirk McKusick的生日，也是PDP-11无条件转移指令的二进制编码）   </li>
<li>a.out的其他内容  </li>
<li>BSS段所需的大小<br> <em>BSS即Block Started by Symbol（由符号开始的块），保存了没有值的变量</em><br> 这里只保存了变量的大小，但并不占据目标文件的任何空间<br> 如：C语言中未初始化的全局变量<br> <strong>注意：局部变量并不进入a.out，而是在运行时创建</strong>    </li>
<li>数据段<br> 包括初始化后的全局变量和静态变量  </li>
<li>文本段<br> 包含可执行文件的指令  </li>
</ol>
</li>
<li>进程的地址空间分布（由低到高）   <ol>
<li>未被映射的虚拟地址空间<br> 任何对它的引用都是非法的，一般包括几K字节，用于捕捉空指针和小整型值的指针引用内存的情况     </li>
<li>文本段    </li>
<li>数据段<br> 通常是进程中最大的段   </li>
<li>BSS段<br> 数据段和BSS段合称数据区      </li>
<li>堆栈段   <ul>
<li>主要有三个用途：   <ol>
<li>为函数内部声明的局部变量提供存储空间    </li>
<li>进行函数调用时，保存相关的维护性信息（过程活动记录等）    </li>
<li>作为暂时的存储区   </li>
</ol>
</li>
<li>函数可以通过参数或全局指针访问它所调用的函数的局部变量，运行时系统维护一个用于提示堆栈当前顶部位置的指针（常位于寄存器中，称为sp）    </li>
</ul>
</li>
</ol>
</li>
<li>C不支持函数嵌套的原因<br>  支持函数嵌套的语言一般采取上层引用的访问方式，需要活动记录包含一个指向它的外层函数的活动记录的指针（被称为静态链接），它允许内层过程访问外层过程的活动记录，因此也可以访问外层过程的局部数据；<br>  而C语言所用函数在词法层次中都是最顶层的、分别独立的    </li>
<li>volatile类型修饰符    <ul>
<li>volatile本意为易变的   </li>
<li>用来告知编译器，程序每次使用该变量都要从内存中读取（出于优化目的，编译器有可能会直接在暂存的寄存器中读取）   </li>
<li>常用于多线程编程等情况   </li>
</ul>
</li>
<li>线程控制  <ul>
<li>头文件：<code>&lt;setjmp.h&gt;</code>   </li>
<li><code>setjmp( jmp_buf j )</code>：保存当前的过程活动记录到j，并返回0   </li>
<li><code>longjmp( jmp_buf j, int i )</code>：跳转到变量j所在的过程活动记录位置，并返回i     </li>
<li><code>setjmp / longjmp</code>和<code>{标签} / goto</code>：<br>  前者只能跳转回曾经到过的地方，后者可以任意设置标签的位置<br>  后者不能跳出函数，前者甚至可以跳转到其他文件的函数    </li>
<li>为了保证跳转过程中局部变量的可靠性，应使用volatile类型修饰符    </li>
<li>常用于错误修复（发现不可修复的错误即把控制转入主输入循环，重新开始）、从深层嵌套的函数中跳出等   </li>
<li>跟goto一样，这样控制线程会使程序难以理解和调试，应尽量避免使用     </li>
</ul>
</li>
<li>UNIX和MS-DOS中的堆栈段   <ul>
<li>UNIX的堆栈段是自动生长的<br>  当试图访问系统分配给堆栈的空间之外时，将会产生一个硬件中断，称为页错误<br>  一般，内核会通过向进程发送合适的信号（可能是段错误）来处理无效地址的引用   </li>
<li>DOS的堆栈段是不可增长的，建立可执行文件时必须确定     </li>
</ul>
</li>
<li>常用的C语言工具    <ul>
<li>源代码检查：<ul>
<li>cb：C程序美化器，使源文件有标准的布局和缩进格式    </li>
<li>lint：C程序检查器   </li>
</ul>
</li>
<li>可执行文件检查：   <ul>
<li>dis：（<code>/usr/ccs/bin</code>）目标代码反汇编工具     </li>
<li>nm：（<code>/usr/ccs/bin</code>）打印目标文件的符号表     </li>
</ul>
</li>
<li>调试：<ul>
<li>debugger：交互式调试器   </li>
</ul>
</li>
<li>性能优化：   <ul>
<li>time：（<code>/usr/bin/time</code>）显示程序所使用的实际使用和CPU时间   </li>
</ul>
</li>
</ul>
</li>
<li>内存媒介（速度、成本依次增加）<br>  磁带、硬盘、内存、cache存储器、CPU寄存器   </li>
<li>虚拟内存    <ul>
<li>以“页”为单位（一般为几K）在磁盘和内存之间来回移动（page in为移入内存，page out为移到硬盘），也以“页”为单位对内存进行保护    </li>
<li>只有用户进程的内存在会被换进还出，系统内核进程常驻于物理内存当中    </li>
<li>进程只能操作位于物理内存中的页面<br>  当进程引用一个不存在于物理内存中的页面时，MMU（内存管理单元，负责支持虚拟内存的硬件）会产生“页错误”。内核将对事件作出响应，<br>  若判断有效，内核将从硬盘中取回对应的页，换入物理内存当中<br>  若判断无效，内核将向进程发出一个“segmentation violation（段违规）”信号   </li>
</ul>
</li>
<li>Cache存储器    <ul>
<li>从MMU的角度看，不同机器Cache存储器的所属不同    <ul>
<li>有些机器的Cache属于CPU一侧，Cache采用的是虚拟地址，每次切换进程时，它的内容必须进行刷新    </li>
<li>有些机器的Cache属于物理内存一侧，Cache采用的是物理地址，容易使多个CPU共享同一个Cache    </li>
</ul>
</li>
<li>数据以“行”（一般为16字节或32字节）为单位从内存中读入Cache     </li>
<li>所有对内存的读写都要经过Cache<br>  当处理器需要从某个特定的地址提取数据时，这个请求首先递交给Cache<br>  如果数据已存在于Cache，它可以被直接提取；<br>  否则，Cache向内存传递这个请求，进行较缓慢的访问内存操作，并将数据读取到Cache     </li>
<li>常见的Cache类型    <ul>
<li>全写法Cache：每次写入Cache时同时写入内存，保持两者内容一致   </li>
<li>写回法Cache：第一次写入时，只写入Cache；再次写入时，此时会把之前的数据写入到内存中保存起来；内核切换进程时，Cache数据都要写入内存中去   </li>
</ul>
</li>
</ul>
</li>
<li>拷贝整个数组<br>  用库函数<code>memcpy( 目的数组, 源数组, 元素个数 )</code>进行快速拷贝<br>  <em>比循环拷贝快的多</em>     </li>
<li>malloc请求申请的内存大小为方便起见通常会被圆整为2的乘方    </li>
<li>生存时间长的程序需要管理动态内存的分配和回收，堆经常会出现两种问题：    <ul>
<li>内存损坏：释放或改写仍在使用的内存    </li>
<li>内存泄漏：未释放不再使用的内存    </li>
</ul>
</li>
<li>alloca分配的动态内存，在离开函数时会被自动释放<br>  可以避免内存损坏和内存泄漏，但是不适用于创建比其所在函数生命周期更长的结构    </li>
<li>体积大的进程更有可能被系统换出，换进换出的时间也更长    </li>
<li>总线错误（bus error）   <ul>
<li>主要是未对齐的读写引起的<br>  对齐：数据项只能存储在地址是数据项大小的整倍数的内存位置上，通过迫使每个内存访问局限在一个Cache行或一个单独的页面内，可以极大的简化并加速如Cache控制器和MMU等硬件<br>  出现未对齐的内存访问请求时，被堵塞的组件就是地址总线     </li>
<li>也有可能是引用物理上不存在的内存引起    </li>
</ul>
</li>
<li>段错误（segmentation fault）   <ul>
<li>MMU异常导致的错误，通常由解除引用一个未初始化或非法值的指针引起<br>  <strong>但是，如果未初始化的指针恰好具有未对齐的值，它会引起总线错误但不引起段错误</strong>      </li>
<li>导致段错误的常见直接原因：   <ol>
<li>解除引用一个包含非法值的指针     </li>
<li>解除引用一个空指针    </li>
<li>在未得到正确的权限时进行访问（如往只读的文本段存储值）           </li>
<li>堆栈或堆空间用完    </li>
</ol>
</li>
<li>导致段错误的常见编程错误：    <ol>
<li>坏指针值错误<br> 对未初始化的指针解除引用，或向库函数传递一个坏指针，或解除引用已经被释放的指针<br> <strong>建议养成指针释放后立即将其设置为NULL的习惯</strong>      </li>
<li>改写错误<br> 越过数组边界写入数据，或在动态分配的内存之外写入数据，或改写一些堆管理数据结构    </li>
<li>指针释放引起的错误<br> 多次释放同一块内存，或释放一块未分配的内存，或释放一个无效指针     </li>
</ol>
</li>
</ul>
</li>
<li>类型提升<br>  在所有表达式中，char都会被提升为int，float都会被提升为double<br>  <em>在老式编译器中，传参的时候也会被提升类型，然后再被适当裁剪</em><br>  <em>意义：简化编译器，压到堆栈中的参数都是同一长度的，运行时只需要知道参数数量，而不需要知道他们的长度</em><br>  但是，在新风格的函数定义下，已经声明过原型的函数，其参数不会进行类型提升，即char会直接以char类型进行传参     </li>
<li>如果库函数调用或系统调用出错，程序会设置全局变量<code>errno</code>的值来提示问题原因<br>  <strong>注意：只有确实出现问题时，errno的值才是有效的</strong><br>  用法：在函数调用或系统调用前先设置全局变量<code>errno = 0;</code>，函数调用后再检查errno的值<br>  具体数值与其对应的错误类型参见<a href="http://baike.baidu.com/link?url=7YW0e9mAIPMy7oKijfh4hgrsEy7m96YNN8BHedQV9A5zPA-OO8HUKDs6e1ACx_6imL24GK-tSDkwiCSjf2docq#2" target="_blank" rel="external">errno_百度百科</a>        </li>
<li>C语言与有限状态机（Finite State Machine）    <ul>
<li>FSM用于基于输入的在几个不同的可选动作中进行循环的程序     </li>
<li>基本思路：用一张表保存所有可能的状态，并列出进入每个状态时可能执行的所有动作，其中最后一个动作就是计算（通常是在当前状态和下一次输入的基础上，再经过一次查询）下一个应该进入的状态    </li>
<li>C语言实现：绝大多数基于函数指针数组，状态函数返回一个通用的函数指针（void *），再转换为适当的类型    </li>
<li>分析环（最简单的FSM）   <ul>
<li>分析环用于绝大多数状态转换都是按连续的顺序进行的，与输入无关的程序     </li>
<li>不需要建立一个转换表用于匹配状态/输入以获得下次状态     </li>
</ul>
</li>
<li>直接用switch语句和循环也可以实现简单的FSM     </li>
</ul>
</li>
<li>如果函数的参数涉及多个不同的参数，可以考虑使用类似<code>int argc, char *argv[]</code>的参数计数器和一个字符串指针数组      </li>
<li>可调试性编码：<br>  把系统分成几个部分，先让程序总体结构运行，再逐步细化调试     </li>
<li>程序的提示信息应具有启发性，而非煽动性，要避免使用带有亵渎性、口语化、幽默（平时自己的小程序还是该幽默点的好QAQ）或者夸张的非专业用语     </li>
<li>使用realloc()函数时，不应直接把返回值直接赋给原指针<br>  否则，一旦realloc失败，返回NULL，那么将无法重新访问、或是释放原来的内存块     </li>
<li><a href="/2015/08/31/指针&amp;数组">指针&amp;数组</a>   </li>
<li>复合符号中间不允许嵌有空白<br>  以<code>a---b</code>为例，   <ul>
<li>根据C语言词法分析器的“贪心法”处理策略，<br>  该表达式应被视为<code>( a-- ) - b</code>     </li>
<li>在变量与符号之间添加空白，如<code>a ---   b</code>是没有问题的，    </li>
<li>但如果在符号之间添加空白，会使符号失去原意，产生准二义性问题，<br>  如<code>a - -- b</code>将被解释为<code>a - ( --b )</code>     </li>
<li>除了<strong><code>++</code></strong>和<strong><code>--</code></strong>之外，<strong><code>/*</code></strong>等也可能产生准二义性问题<br>  如<code>y=x/*p</code>中<code>/*</code>会被解释为<strong>注释起始</strong><br>  而<code>y = x / * p</code>中<code>/</code>和<code>*</code>会分别被解释为 <strong>除法</strong> 和 <strong>解除引用</strong>    </li>
</ul>
</li>
<li>else始终与 <strong>同一对括号内</strong> <strong>最近</strong> 的 <strong>未匹配</strong> 的if结合     </li>
</ul>

        
      </div>
    

    
      <div class="post-footer">
        
          <div class="post-tags">
            
              <a href="/tags/C/">
                #C
              </a>
            
          </div>
        

        
          <div class="post-nav">
            <div class="post-nav-prev post-nav-item">
              
                <a href="/2015/08/31/指针&数组/">指针&数组</a>
              
            </div>

            <div class="post-nav-next post-nav-item">
              
                <a href="/2015/08/12/vim实用技巧/">《vim实用技巧》笔记</a>
              
            </div>
          </div>
        

        
        
      </div>
    
  </div>



  
    <div class="comments" id="comments">
      
    </div>
  

          </div>

          
        </div>

        
<div class="sidebar-toggle">
  <div class="sidebar-toggle-line-wrap">
    <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
    <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
    <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
  </div>
</div>

<div id="sidebar" class="sidebar">
  <div class="sidebar-inner">

    
      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
          文章目錄
        </li>
        <li class="sidebar-nav-overview" data-target="site-overview">
          本站概覽
        </li>
      </ul>
    

    <div class="site-overview">
      <div class="site-author motion-element">
        <img class="site-author-image" src="http://img4.duitang.com/uploads/item/201407/11/20140711151916_MCEKj.jpeg" alt="ZhengKai" />
        <p class="site-author-name">ZhengKai</p>
      </div>
      <p class="site-description motion-element"></p>
      <div class="site-state motion-element">
        <div class="site-state-item site-state-posts">
          <a href="/archives">
            <span class="site-state-item-count">18</span>
            <span class="site-state-item-name">文章</span>
          </a>
        </div>

        <div class="site-state-item site-state-categories">
          
            <span class="site-state-item-count">0</span>
            <span class="site-state-item-name">分類</span>
          
        </div>

        <div class="site-state-item site-state-tags">
          <a href="/tags">
            <span class="site-state-item-count">16</span>
            <span class="site-state-item-name">標籤</span>
          </a>
        </div>

      </div>

      

      <div class="links-of-author motion-element">
        
      </div>

      
      

    </div>

    
      <div class="post-toc-wrap sidebar-panel-active">
        <div class="post-toc-indicator-top post-toc-indicator"></div>
        <div class="post-toc">
          
          
            <p class="post-toc-empty">此文章未包含目錄</p>
          
        </div>
        <div class="post-toc-indicator-bottom post-toc-indicator"></div>
      </div>
    

  </div>
</div>


      </div>
    </div>

    <div id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy; &nbsp; 
  2015
  <span class="with-love">
    <i class="icon-heart"></i>
  </span>
  <span class="author">ZhengKai</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 強力驅動
</div>

<div class="theme-info">
  主題 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>



      </div>
    </div>

    <div class="back-to-top"></div>
  </div>

  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>
  <script type="text/javascript">
    $(document).ready(function() {
      $('.content img').each(function () {
        var $image = $(this);
        var $imageWrapLink = $image.parent('a');

        if ($imageWrapLink.size() < 1) {
          $imageWrapLink = $image.wrap('<a href="' + this.getAttribute('src') + '"></a>').parent('a');
        }
        $imageWrapLink.addClass('fancybox');
      });
    });
    $('.fancybox').fancybox({
      helpers: {
        overlay: {
          locked: false
        }
      }
    });
  </script>


  <script type="text/javascript">
  function hasMobileUA () {
    var nav = window.navigator;
    var ua = nav.userAgent;
    var pa = /iPad|iPhone|Android|Opera Mini|BlackBerry|webOS|UCWEB|Blazer|PSP|IEMobile|Symbian/g;

    return pa.test(ua);
  }

  function isDesktop () {
    return screen.width > 991 && !hasMobileUA();
  }

  function isTablet () {
    return screen.width < 992 && screen.width > 767 && hasMobileUA();
  }

  function isMobile () {
    return screen.width < 767 && hasMobileUA();
  }

  function escapeSelector (selector) {
    return selector.replace(/[!"$%&'()*+,.\/:;<=>?@[\\\]^`{|}~]/g, "\\$&")
  }
</script>

  

  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

  <script type="text/javascript" id="motion.global">
  $(document).ready(function () {
    var body = $('body');
    var isSidebarVisible = false;
    var sidebarToggle = $('.sidebar-toggle');
    var sidebarToggleLine1st = $('.sidebar-toggle-line-first')
    var sidebarToggleLine2nd = $('.sidebar-toggle-line-middle');
    var sidebarToggleLine3rd = $('.sidebar-toggle-line-last');
    var sidebar = $('.sidebar');

    var SIDEBAR_WIDTH = '320px';
    var SIDEBAR_DISPLAY_DURATION = 300;

    var sidebarToogleLineStatusInit = {width: '100%', opacity: 1, left: 0, rotateZ: 0, top: 0};

    var sidebarToggleLine1stStatusInit = sidebarToogleLineStatusInit;
    var sidebarToggleLine1stStatusArrow = {width: '50%', rotateZ: '-45deg', top: '2px'};
    var sidebarToogleLine1stStatusClose = {width: '100%', rotateZ: '-45deg', top: '5px'};

    var sidebarToggleLine2ndStatusInit = sidebarToogleLineStatusInit;
    var sidebarToggleLine2ndStatusArrow = {width: '90%'};
    var sidebarToogleLine2ndStatusClose = {opacity: 0};

    var sidebarToggleLine3rdStatusInit = sidebarToogleLineStatusInit;
    var sidebarToggleLine3rdStatusArrow = {width: '50%', rotateZ: '45deg', top: '-2px'};
    var sidebarToogleLine3rdStatusClose = {width: '100%', rotateZ: '45deg', top: '-5px'};

    LogoAndMenuMotion();
    sidebatToggleMotion();
    postsListMotion();
    backToTopMotion();


    $(document)
      .on('sidebar.isShowing', function () {
        isDesktop() && body.velocity(
          {paddingRight: SIDEBAR_WIDTH},
          SIDEBAR_DISPLAY_DURATION
        );
        sidebarContentMotion();
      })
      .on('sidebar.isHiding', function () {});

    function LogoAndMenuMotion() {
      $.Velocity.RunSequence([
        { e: $('.brand'), p: { opacity: 1 }, o: { duration: 100 } },
        { e: $('.logo'), p: { opacity: 1, top: 0 }, o: { duration: 50} },
        
        { e: $('.logo-line-before i'), p: { translateX: "100%" }, o: { duration: 500, sequenceQueue: false } },
        { e: $('.logo-line-after i'), p: { translateX: "-100%" }, o: { duration: 500, sequenceQueue: false } },
        
        { e: $('.site-title'), p: { opacity: 1, top: 0 }, o: { duration: 200 } }
      ]);
      $('.menu-item').velocity('transition.slideDownIn', {display: null});
    }


    function backToTopMotion () {
      var b2top = $('.back-to-top');
      b2top.on('click', function () {
        body.velocity('scroll');
      });
    }

    function sidebarShowMotion () {

      sidebarToggleLine1st.velocity(sidebarToogleLine1stStatusClose);
      sidebarToggleLine2nd.velocity(sidebarToogleLine2ndStatusClose);
      sidebarToggleLine3rd.velocity(sidebarToogleLine3rdStatusClose);

      sidebar.velocity({width: SIDEBAR_WIDTH}, {
        display: 'block',
        duration: SIDEBAR_DISPLAY_DURATION,
        complete: function () {
          sidebar.addClass('sidebar-active');
          sidebar.trigger('sidebar.didShow');
        }
      });
      sidebar.trigger('sidebar.isShowing');
    }

    function sidebarHideMotion () {
      isDesktop() && body.velocity({paddingRight: 0});
      sidebar.velocity('reverse');

      sidebarToggleLine1st.velocity(sidebarToggleLine1stStatusInit);
      sidebarToggleLine2nd.velocity(sidebarToggleLine2ndStatusInit);
      sidebarToggleLine3rd.velocity(sidebarToggleLine3rdStatusInit);

      sidebar.removeClass('sidebar-active');
      sidebar.trigger('sidebar.isHiding');
    };

    function sidebarContentMotion () {
      $('.sidebar .motion-element').velocity(
        'transition.slideRightIn',
        {stagger: 50, drag: true}
      );
    }

    function postsListMotion () {
      var postMotionOptions = window.postMotionOptions || {stagger: 300, drag: true};
      $('.post').velocity('transition.slideDownIn', postMotionOptions);
    }

    function sidebatToggleMotion () {
      sidebarToggle.on('click', function () {
        isSidebarVisible ? sidebarHideMotion() : sidebarShowMotion();
        isSidebarVisible = !isSidebarVisible;
      });

      sidebarToggle.hover(function () {
        if (isSidebarVisible) {return}
        sidebarToggleLine1st.velocity('stop').velocity(sidebarToggleLine1stStatusArrow);
        sidebarToggleLine2nd.velocity('stop').velocity(sidebarToggleLine2ndStatusArrow);
        sidebarToggleLine3rd.velocity('stop').velocity(sidebarToggleLine3rdStatusArrow);
      }, function () {
        if (isSidebarVisible) {return}
        sidebarToggleLine1st.velocity('stop').velocity(sidebarToggleLine1stStatusInit);
        sidebarToggleLine2nd.velocity('stop').velocity(sidebarToggleLine2ndStatusInit);
        sidebarToggleLine3rd.velocity('stop').velocity(sidebarToggleLine3rdStatusInit);
      });
    }
  });

</script>





  
  
<script type="text/javascript" id="bootstrap.scrollspy.custom">
  /* ========================================================================
  * Bootstrap: scrollspy.js v3.3.2
  * http://getbootstrap.com/javascript/#scrollspy
  * ========================================================================
  * Copyright 2011-2015 Twitter, Inc.
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
  * ======================================================================== */

  /**
   * Custom by iissnan
   *
   * - Add a `clear.bs.scrollspy` event.
   * - Esacpe targets selector.
   */


  +function ($) {
    'use strict';

    // SCROLLSPY CLASS DEFINITION
    // ==========================

    function ScrollSpy(element, options) {
      this.$body          = $(document.body)
      this.$scrollElement = $(element).is(document.body) ? $(window) : $(element)
      this.options        = $.extend({}, ScrollSpy.DEFAULTS, options)
      this.selector       = (this.options.target || '') + ' .nav li > a'
      this.offsets        = []
      this.targets        = []
      this.activeTarget   = null
      this.scrollHeight   = 0

      this.$scrollElement.on('scroll.bs.scrollspy', $.proxy(this.process, this))
      this.refresh()
      this.process()
    }

    ScrollSpy.VERSION  = '3.3.2'

    ScrollSpy.DEFAULTS = {
      offset: 10
    }

    ScrollSpy.prototype.getScrollHeight = function () {
      return this.$scrollElement[0].scrollHeight || Math.max(this.$body[0].scrollHeight, document.documentElement.scrollHeight)
    }

    ScrollSpy.prototype.refresh = function () {
      var that          = this
      var offsetMethod  = 'offset'
      var offsetBase    = 0

      this.offsets      = []
      this.targets      = []
      this.scrollHeight = this.getScrollHeight()

      if (!$.isWindow(this.$scrollElement[0])) {
        offsetMethod = 'position'
        offsetBase   = this.$scrollElement.scrollTop()
      }

      this.$body
        .find(this.selector)
        .map(function () {
          var $el   = $(this)
          var href  = $el.data('target') || $el.attr('href')
          var $href = /^#./.test(href) && $(escapeSelector(href)) // Need to escape selector.

          return ($href
            && $href.length
            && $href.is(':visible')
            && [[$href[offsetMethod]().top + offsetBase, href]]) || null
        })
        .sort(function (a, b) { return a[0] - b[0] })
        .each(function () {
          that.offsets.push(this[0])
          that.targets.push(this[1])
        })


    }

    ScrollSpy.prototype.process = function () {
      var scrollTop    = this.$scrollElement.scrollTop() + this.options.offset
      var scrollHeight = this.getScrollHeight()
      var maxScroll    = this.options.offset + scrollHeight - this.$scrollElement.height()
      var offsets      = this.offsets
      var targets      = this.targets
      var activeTarget = this.activeTarget
      var i

      if (this.scrollHeight != scrollHeight) {
        this.refresh()
      }

      if (scrollTop >= maxScroll) {
        return activeTarget != (i = targets[targets.length - 1]) && this.activate(i)
      }

      if (activeTarget && scrollTop < offsets[0]) {
        $(this.selector).trigger('clear.bs.scrollspy')  // Add a custom event.
        this.activeTarget = null
        return this.clear()
      }

      for (i = offsets.length; i--;) {
        activeTarget != targets[i]
          && scrollTop >= offsets[i]
          && (!offsets[i + 1] || scrollTop <= offsets[i + 1])
          && this.activate(targets[i])
      }
    }

    ScrollSpy.prototype.activate = function (target) {
      this.activeTarget = target

      this.clear()

      var selector = this.selector +
        '[data-target="' + target + '"],' +
        this.selector + '[href="' + target + '"]'

      var active = $(selector)
        .parents('li')
        .addClass('active')

      if (active.parent('.dropdown-menu').length) {
        active = active
          .closest('li.dropdown')
          .addClass('active')
      }

      active.trigger('activate.bs.scrollspy')
    }

    ScrollSpy.prototype.clear = function () {
      $(this.selector)
        .parentsUntil(this.options.target, '.active')
        .removeClass('active')
    }


    // SCROLLSPY PLUGIN DEFINITION
    // ===========================

    function Plugin(option) {
      return this.each(function () {
        var $this   = $(this)
        var data    = $this.data('bs.scrollspy')
        var options = typeof option == 'object' && option

        if (!data) $this.data('bs.scrollspy', (data = new ScrollSpy(this, options)))
        if (typeof option == 'string') data[option]()
      })
    }

    var old = $.fn.scrollspy

    $.fn.scrollspy             = Plugin
    $.fn.scrollspy.Constructor = ScrollSpy


    // SCROLLSPY NO CONFLICT
    // =====================

    $.fn.scrollspy.noConflict = function () {
      $.fn.scrollspy = old
      return this
    }


    // SCROLLSPY DATA-API
    // ==================

    $(window).on('load.bs.scrollspy.data-api', function () {
      $('[data-spy="scroll"]').each(function () {
        var $spy = $(this)
        Plugin.call($spy, $spy.data())
      })
    })

  }(jQuery);
</script>


<script type="text/javascript" id="sidebar.toc.highlight">
  $(document).ready(function () {
    var tocSelector = '.post-toc';
    var $tocSelector = $(tocSelector);
    var activeCurrentSelector = '.active-current';

    $tocSelector
      .on('activate.bs.scrollspy', function () {
        var $currentActiveElement = $(tocSelector + ' .active').last();

        removeCurrentActiveClass();
        $currentActiveElement.addClass('active-current');

        $tocSelector[0].scrollTop = $currentActiveElement.position().top;
      })
      .on('clear.bs.scrollspy', function () {
        removeCurrentActiveClass();
      });

    function removeCurrentActiveClass () {
      $(tocSelector + ' ' + activeCurrentSelector)
        .removeClass(activeCurrentSelector.substring(1));
    }

    function processTOC () {
      getTOCMaxHeight();
      toggleTOCOverflowIndicators();
    }

    function getTOCMaxHeight () {
      var $sidebarInner = $('.sidebar-inner');
      var height = $('.sidebar').height() -
                   $tocSelector.position().top -
                   $('.post-toc-indicator-bottom').height();

      $tocSelector.css('height', height);

      return height;
    }

    function toggleTOCOverflowIndicators () {
      tocOverflowIndicator(
        '.post-toc-indicator-top',
        $tocSelector.scrollTop() > 0 ? 'show' : 'hide'
      );

      tocOverflowIndicator(
        '.post-toc-indicator-bottom',
        $tocSelector.scrollTop() >= $tocSelector.find('ol').height() - $tocSelector.height() ? 'hide' : 'show'
      )
    }

    $(document).on('sidebar.didShow', function () {
      processTOC();
    });

    $('body').scrollspy({ target: tocSelector });
    $(window).on('resize', function () {
      if ( $('.sidebar').hasClass('sidebar-active') ) {
        processTOC();
      }
    });

    onScroll($tocSelector);

    function onScroll (element) {
      element.on('mousewheel DOMMouseScroll', function (event) {
          var oe = event.originalEvent;
          var delta = oe.wheelDelta || -oe.detail;
          var self = this;

          this.scrollTop += ( delta < 0 ? 1 : -1 ) * 30;
          event.preventDefault();

          toggleTOCOverflowIndicators();
      });
    }

    function tocOverflowIndicator (indicator, action) {
      $(indicator).velocity('stop').velocity({
        opacity: action === 'show' ? 0.4 : 0
      }, { duration: 100 });
    }

  });
</script>


  <script type="text/javascript" id="sidebar.nav">
    $(document).ready(function () {
      var html = $('html');

      $('.sidebar-nav li').on('click', function () {
        var item = $(this);
        var activeTabClassName = 'sidebar-nav-active';
        var activePanelClassName = 'sidebar-panel-active';
        if (item.hasClass(activeTabClassName)) {
          return;
        }

        var currentTarget = $('.' + activePanelClassName);
        var target = $('.' + item.data('target'));

        currentTarget.velocity('transition.slideUpOut', 200, function () {
          target
            .velocity('stop')
            .velocity('transition.slideDownIn', 200)
            .addClass(activePanelClassName);
        });

        item.siblings().removeClass(activeTabClassName);
        item.addClass(activeTabClassName);
      });

      $('.post-toc a').on('click', function (e) {
        e.preventDefault();
        var offset = $(escapeSelector(this.getAttribute('href'))).offset().top;
        html.velocity('stop').velocity('scroll', {
          offset: offset  + 'px',
          mobileHA: false
        });
      });

      // Expand sidebar on post detail page by default, when post has a toc.
      var $tocContent = $('.post-toc-content');
      if ($tocContent.length > 0 && $tocContent.html().trim().length > 0 && isDesktop()) {
        setTimeout(function () {
          $('.sidebar-toggle').trigger('click');
        }, 800);
      }
    });
  </script>




  

  
  

  


  
</body>
</html>
